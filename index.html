<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Optimizely for iOS by optimizely</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Optimizely for iOS</h1>
        <p class="header">Mobile A/B Testing You&#39;ll Actually Use</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/optimizely/Optimizely-iOS-SDK/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/optimizely/Optimizely-iOS-SDK/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/optimizely/Optimizely-iOS-SDK">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/optimizely">optimizely</a></p>


      </header>
      <section>
        <h1>
<a name="optimizely-ios-sdk-quickstart-guide" class="anchor" href="#optimizely-ios-sdk-quickstart-guide"><span class="octicon octicon-link"></span></a>Optimizely iOS SDK Quickstart Guide</h1>

<h2>
<a name="table-of-contents" class="anchor" href="#table-of-contents"><span class="octicon octicon-link"></span></a>Table of Contents</h2>

<ol>
<li><a href="#accountcreation">Creating an Optimizely Project</a></li>
<li><a href="#installation">SDK Installation</a></li>
<li><a href="#quickstart">Creating your first experiment</a></li>
</ol><h2>
<a name="creating-an-ios-project" class="anchor" href="#creating-an-ios-project"><span class="octicon octicon-link"></span></a><a name="accountcreation"></a>Creating an iOS Project</h2>

<p>To create an iOS project, select "Create New Project" in the <a href="https://www.optimizely.com/dashboard">Optimizely Dashboard</a>:</p>

<p><img src="create-project.png" alt="Drawing"></p>

<p>Once you've created a project, please take a look at the <code>Project Code</code> dialog to find your project ID and API key which you will use during installation:</p>

<p><img src="project-code.png" alt="Project Code Dialog"></p>

<h2>
<a name="sdk-installation" class="anchor" href="#sdk-installation"><span class="octicon octicon-link"></span></a><a name="installation"></a>SDK Installation</h2>

<p>To use Optimizely for iOS you must first integrate the SDK into your app. You can either install the Optimizely SDK using <a href="http://cocoapods.org">CocoaPods</a> (recommended) or manually.</p>

<h3>
<a name="using-cocoapods" class="anchor" href="#using-cocoapods"><span class="octicon octicon-link"></span></a>Using CocoaPods</h3>

<p>Refer to <a href="http://cocoapods.org/#getstarted">CocoaPods Getting Started</a> if you haven't yet configured your project to work with CocoaPods.</p>

<ol>
<li>
<p>Our SDK only supports iOS 6.0 and above, so please make sure your Podfile specifies a <a href="http://guides.cocoapods.org/syntax/podfile.html#platform">deployment target</a> of iOS 6.0 (or above). Then, add Optimizely to your podfile:</p>

<pre><code>platform :ios, '6.0'

# Other Pods 
pod 'Optimizely-iOS-SDK', :git =&gt; 'git@github.com:optimizely/Optimizely-iOS-SDK.git'
</code></pre>
</li>
<li><p>Run <code>pod install</code> from the command line.  This will add and install the Optimizely iOS SDK in your generated CocoaPods workspace. <em>Note:</em> by default CocoaPods installs to the first build target in the project.</p></li>
<li>
<p>Now you're ready to write some code! Open your app's prefix header file: <code>MyApp-Prefix.pch</code> under 'Supporting Files' in a standard XCode project. Add the following line of code to the bottom:</p>

<pre><code>#import &lt;Optimizely/Optimizely.h&gt;
</code></pre>
</li>
</ol><p>4 Add the following to the beginning of <code>application:didFinishLaunchingWithOptions:</code> in your
app delegate:</p>

<pre><code>- (void)application:(UIApplication*)application didFinishLaunchingWithOptions:(...) {

        #ifdef DEBUG
        [Optimizely enableEditor];
        #endif

        [Optimizely startOptimizelyWithAPIToken:@"YOUR-API-TOKEN" launchOptions:launchOptions];

                // The rest of your initialization code...
    }
</code></pre>

<p>You can copy-paste your API token from the <code>Project Code</code> dialog within your Optimizely iOS project.</p>

<p>If you have trouble connectiong to the Optimizely Editor in your development environment, remove the <code>#ifdef DEBUG â€¦ #endif</code> flag and force-enable the editor (just don't ship your production app with the Editor enabled!)</p>

<h3>
<a name="manual-installation" class="anchor" href="#manual-installation"><span class="octicon octicon-link"></span></a>Manual Installation</h3>

<ol>
<li><p>Clone the Optimizely SDK using <code>git clone https://github.com/optimizely/Optimizely-IOS-SDK</code></p></li>
<li><p>Drag <code>Optimizely.framework</code> from the SDK repository into your project. Check "Copy items into destination group's folder" and make sure the appropriate targets are checked.</p></li>
<li>
<p>Open the "Build Phases" tab for the app's target. Under "Link Binary with Libraries", add the required frameworks if they're not already included:</p>

<ul>
<li>AdSupport.framework</li>
<li>CFNetwork.framework</li>
<li>Foundation.framework</li>
<li>libicucore.dylib</li>
<li>libsqlite3.dylib</li>
<li>Security.framework</li>
<li>SystemConfiguration.framework</li>
<li>UIKit.framework<br>
</li>
</ul>
</li>
<li><p>Switch to the "Build Settings" tab. Add <code>-ObjC</code> to the "Other Linker Flags" build setting.</p></li>
<li><p>Drag <code>scripts/OptimizelyPrepareNibs.py</code> from the SDK into your project. Check "Copy items into destination group's folder" and <strong>uncheck all targets</strong>.</p></li>
<li>
<p>Open the "Build Phases" tab for the app's target. In the app menu (top of the screen) click "Editor" -&gt; "Add Build Phase" -&gt; "Add Run Script Build Phase". In the script field, write:</p>

<pre><code>python "$SRCROOT/OptimizelyPrepareNibs.py"
</code></pre>

<p>This script needs to run at the start of the build process (right after Target Dependencies). To make sure this happens, drag the Run Script phase you just added to the top of the list of phases, just under "Target Dependencies". The final result should look something like this:</p>

<p><img src="screenshot-run-build-phase.png" alt="Build Targets Screenshot"></p>
</li>
<li>
<p>Now you're ready to write some code! Open your app's prefix header file: <code>MyApp-Prefix.pch</code> under 'Supporting Files' in a standard XCode project. Add the following line of code to the bottom:</p>

<pre><code>#import &lt;Optimizely/Optimizely.h&gt;
</code></pre>
</li>
<li>
<p>Add the following to the beginning of <code>application:didFinishLaunchingWithOptions:</code> in your
app delegate:</p>

<pre><code>- (void)application:(UIApplication*)application didFinishLaunchingWithOptions:(...) {

    #ifdef DEBUG
    [Optimizely enableEditor];
    #endif

    [Optimizely startOptimizelyWithAPIToken:@"YOUR-API-TOKEN" launchOptions:launchOptions];

    // The rest of your initialization code...
}
</code></pre>
</li>
</ol><h3>
<a name="external-dependencies" class="anchor" href="#external-dependencies"><span class="octicon octicon-link"></span></a>External Dependencies</h3>

<p>There are a few external libraries used by the Optimizely SDK. These ship with the Optimizely SDK so there is no need to install them separately.</p>

<ul>
<li>
<a href="https://github.com/AFNetworking/AFNetworking">AFNetworking</a>:
used for making network requests.</li>
<li>
<a href="https://github.com/steipete/AFDownloadRequestOperation">AFDownloadRequestOperation</a>:
used to download assets, with the ability to resume interrupted downloads.</li>
<li>
<a href="https://github.com/ccgus/fmdb">FMDB</a>:
Objective-C wrapper for sqlite.</li>
<li>
<a href="https://github.com/square/SocketRocket">SocketRocket</a>:
used to communicate with the web editor over websockets.</li>
</ul><h2>
<a name="creating-your-first-experiment" class="anchor" href="#creating-your-first-experiment"><span class="octicon octicon-link"></span></a><a name="quickstart"></a>Creating your first experiment</h2>

<p>This guide will walk you through setting up your first experiment using UIView Swizzling. If you are using Interface Builder or Storyboards, this is already available to you. However, if you are creating your views programmatically, jump ahead to <a href="#uiswizzling">UISwizzling</a> and then return to this guide. </p>

<h3>
<a name="setting-up-variations" class="anchor" href="#setting-up-variations"><span class="octicon octicon-link"></span></a>Setting up Variations</h3>

<ol>
<li>
<p>In the <a href="http://optimizely.com/dashboard">Optimizely Application</a>, select the project that you created at the start of the installation process and click "Create Experiment".</p>

<p><img src="editor-create-experiment.png" alt="Drawing"></p>
</li>
<li>
<p>Once you have chosen a name and created the experiment, the editor begins waiting for a device to enter edit mode. If you haven't already, <strong>run your app in DEBUG mode in the simulator or on a device</strong>. You should see the device appear in the editor. If you don't, check out the troubleshooting section of this guide or <a href="mailto:mobile-support@optimizely.com">email support</a>.</p>

<p><img src="editor-select-device.png" alt="Drawing"></p>
</li>
<li>
<p>Once you have connected your device, it's time to create a variation.</p>

<p><img src="editor-views.png" alt="Drawing"></p>

<ol>
<li>In your app, navigate to the screen on which you want to run an experiment.</li>
<li>As you mouse over the different elements in the side bar, you should see them highlighted in the app.</li>
<li>When you select the view element that you want to change, the right section of the screen should populate with the properties that you can change on that element.</li>
<li>The change is immediately reflected in your app! Click save to commit your change(s) to the variation.</li>
</ol>
</li>
</ol><h4>
<a name="previewing-your-variation" class="anchor" href="#previewing-your-variation"><span class="octicon octicon-link"></span></a>Previewing your variation</h4>

<p>To simulate a user's experience when they are in a particular variation, you can use preview mode. Select the variation you want to see and click the 'Preview' button in the top right corner of the screen. This will cause the app to shut down. When you reopen the app, it will have all the changes you specified in your variation.</p>

<p><img src="editor-preview-button.png" alt="Drawing"></p>

<h3>
<a name="goals" class="anchor" href="#goals"><span class="octicon octicon-link"></span></a>Goals</h3>

<p>All experiments must have at least one goal! We automatically track all view controller transitions and screen taps so that they can easily be used as goals. In order to select a particular transition or screen tap as a goal, open the "Goals" dialogue and click "New Goal" in the bottom right.</p>

<p><img src="editor-add-goal.png" alt="Drawing"></p>

<p>On this screen, you will see all the transitions and taps occurring in your app as you interact with it on your device. Select the one that you want to be your goal and click "Done". Optimizely will now track the percentage of your users in each variation that complete that action and the results will appear in our dashboard. If you're curious about the "Create Custom Goal Instead" button, jump ahead to <a href="#customgoals">Custom Goals</a>.</p>

<h4>
<a name="optional-allocating-experiment-traffic" class="anchor" href="#optional-allocating-experiment-traffic"><span class="octicon octicon-link"></span></a><em>Optional: Allocating Experiment Traffic</em>
</h4>

<p>By default, an equal percentage of your traffic will see each variation. If you want to change from the default, you can adjust the targeting allocation from the Options menu.</p>

<p><img src="editor-traffic-allocation.png" alt="Drawing"></p>

<h2>
<a name="advanced-testing-info" class="anchor" href="#advanced-testing-info"><span class="octicon octicon-link"></span></a>Advanced Testing Info</h2>

<p>For additional information about any of the experimental approaches below, see the full <a href="../help/html/Classes/Optimizely.html">API Documentation</a>.</p>

<h3>
<a name="uiswizzling-" class="anchor" href="#uiswizzling-"><span class="octicon octicon-link"></span></a>UISwizzling <a name="uiswizzling"></a>
</h3>

<p>The Optimizely editor becomes aware of views it can swizzle by looking for views that have an <code>optimizelyId</code> property. When a view with an <code>optimizelyId</code> becomes visible in the app, the SDK alerts the web editor of its existence, as well as the existence of all of its children. The <code>OptimizelyPrepareNibs.py</code> script assigns an <code>optimizelyId</code> automatically to views created with Interface Builder or Storyboards. For automatically tagged views, the behavior will be as follows:</p>

<ul>
<li>Optimizely will assign randomly generated <code>optimizelyIDs</code> to each UIView prototype in your app; an example might be "MainView-w389gjw" using the OptimizelyPrepareNibs.py script.</li>
<li>Each UIView will become available in the Optimizely Mobile Editor on <a href="www.optimizely.com">optimizely.com</a>.</li>
<li>
<strong>Important</strong>: When you make changes to a UIView or child object in the Optimizely Mobile Editor, those changes will affect all instances of the that object prototype. Selecting a UIImage object in an infinite-scroll list will appear to modify the most recently created object (usually on the bottom), but will affect all instances of that object once the experiment is running live. <em>Please use the Preview functionality to verify this behavior before running your experiment.</em>
</li>
</ul><p>If you are creating views programmatically, you must set the <code>optimizelyId</code> manually:</p>

<pre><code>UILabel *label = [[UILabel alloc] initWithFrame:...];
label.optimizelyId = @"pricing-title-label";
</code></pre>

<p>For any views that you want to swizzle, you should give them a unique <code>optimizelyId</code>. All the subviews of that view will also automatically become visible to the editor, so there's no need to assign an <code>optimizelyId</code> to each subview. A good guideline is that you need to assign an <code>optimizelyId</code> to the view of each of your view controllers.</p>

<h3>
<a name="code-blocks" class="anchor" href="#code-blocks"><span class="octicon octicon-link"></span></a>Code blocks</h3>

<p>This allows developers to execute different code paths based on the active experiment and variation. Users will be randomly bucketed into a particular variation and the variationId passed into the block will reflect their bucket. This is the most powerful method for creating experiments, but requires the app to be resubmitted to the app store.</p>

<p>To implement, please see the <a href="../help/html/Classes/Optimizely.html#//api/name/codeTest:withBlocks:defaultBlock:">Code Blocks API Reference</a></p>

<h3>
<a name="named-variables" class="anchor" href="#named-variables"><span class="octicon octicon-link"></span></a>Named variables</h3>

<p>The values of named variables can be affected from the "Variables" tab in the editor. This tab shows all named variables <strong>that have been used while the app is connected to the editor</strong>. If a named variable is only used in a view that you have not visited yet, it will not appear in the list of named variables until you navigate to that view. There are three ways that the Optimizely editor becomes aware of variables it can change:</p>

<p><strong>Registered variables</strong> are the explicit way of setting the value for variables. Variables are defined in the user's code as seen below, with a (unique) associated key. Once a variable is registered, variations can change the value of variables based on their key. For example, you can create an experiment that tests different values for gravity.</p>

<pre><code>NSNumber *gravity = [[Optimizely sharedInstance] numberForKey:@"gravity" defaultValue:@(9.8)];
</code></pre>

<p><strong>NSLocalizedString</strong> allows for a less explicit way of changing strings, and requires less integration if the user has already localized their app. The Optimizely SDK automatically displays any <code>NSLocalizedStrings</code> in your app and enables you to change their value.</p>

<pre><code>NSString *buttonLabel = NSLocalizedString(@"Sign up!");
</code></pre>

<p><strong>Bound variables</strong> allow you to set values on class properties. They rely on KVC/KVO.</p>

<pre><code>[[Optimizely sharedInstance] bindNumberForKey:@"retry-count" toKeyPath:@"maxRetries" onObject:foo];
</code></pre>

<h3>
<a name="custom-goals-" class="anchor" href="#custom-goals-"><span class="octicon octicon-link"></span></a>Custom Goals <a name="customgoals"></a>
</h3>

<p>Custom goals allow you to track events other than taps and view changes. There are two steps to creating a custom goal. The first step occurs in the web editor. Click "Goals", then "New Goal", and finally "Create Custom Goal". You will be prompted for a string to uniquely identify your custom goal. In order to track this goal, send this same string as a parameter to </p>

<pre><code>[[Optimizely sharedInstance] trackEvent:(NSString *)]
</code></pre>

<p>You can optionally include revenue information with the goal:</p>

<pre><code>[[Optimizely sharedInstance] trackEvent:(NSString *) revenue:(NSInteger)]
</code></pre>

<p>For example, if we wanted a goal for users deleting a task with a swipe, we might create a custom goal "User Deleted Task" and then call <code>-trackEvent</code> with this string in our event handler as follows:</p>

<pre><code>- (void)userDidSwipeTask:(id)sender {
    [[Optimizely sharedInstance] trackEvent:@"User Deleted Task"];
    //The rest of your handler
}
</code></pre>

<h2>
<a name="troubleshooting" class="anchor" href="#troubleshooting"><span class="octicon octicon-link"></span></a>Troubleshooting</h2>

<p><strong>Q: My device is running the app but I can't see it in the editor.</strong></p>

<p>A: First, confirm your device is connected to the internet. If that turns out to be useless advice, make sure that the API token that you passed into <code>[Optimizely startOptimizelyWithAPIToken:@"YOUR-API-TOKEN" launchOptions:launchOptions];</code> matches what you see in the Project Code box within Optimizely.</p>
      </section>
      <footer>
        <p><small>Hosted on <a href="http://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		          <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-13208639-14");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
